<net.rptools.maptool.model.MacroButtonProperties>
  <macroUUID>983cdb46-4922-46b4-a0d7-f38d29ec6220</macroUUID>
  <saveLocation>Token</saveLocation>
  <index>63</index>
  <colorKey>default</colorKey>
  <hotKey>None</hotKey>
  <command>[h: basicToon = dndb_getBasicToon ()]

[h: speeds = json.get (basicToon, "speeds")]
&lt;!-- blank them out first --&gt;
[h, foreach (speed, "['Walk', 'Swim', 'Fly', 'Climb', 'Burrow']"): setProperty (speed, "")]

[h: noMove = getState ("Paralyzed") + getState ("Grappled") + getState ("Petrified") + getState ("Restrained") + getState ("Stunned") + getState ("Unconscious") + getState ("Exhaustion 5") + getState ("Exhaustion 6")]
[h: onlyCrawl = getState ("Prone")]
[h: halfSpeed = getState ("Exhaustion 3")]
&lt;!-- someday we might want to distinguish between crawl and no speed, but for now they --&gt;
&lt;!-- end up working the same --&gt;
[h, foreach (speed, speeds), code: {
	[h: speedName = json.get (speed, "name")]
	[h: speedValue = round (json.get (speed, "speed"))]
	[h, if (halfSpeed &gt; 0): speedValue = round (math.floor (speedValue / 2)); ""]
	[h, if (noMove + onlyCrawl &gt; 0): speedValue = 0; ""]
	[h: setProperty (speedName, speedValue)]
}]</command>
  <label>dndb_applySpeed</label>
  <group>Basic Toon</group>
  <sortby/>
  <autoExecute>true</autoExecute>
  <includeLabel>false</includeLabel>
  <applyToTokens>true</applyToTokens>
  <fontColorKey>black</fontColorKey>
  <fontSize>1.00em</fontSize>
  <minWidth/>
  <maxWidth/>
  <allowPlayerEdits>true</allowPlayerEdits>
  <toolTip/>
  <displayHotKey>true</displayHotKey>
  <commonMacro>false</commonMacro>
  <compareGroup>true</compareGroup>
  <compareSortPrefix>true</compareSortPrefix>
  <compareCommand>true</compareCommand>
  <compareIncludeLabel>true</compareIncludeLabel>
  <compareAutoExecute>true</compareAutoExecute>
  <compareApplyToSelectedTokens>true</compareApplyToSelectedTokens>
</net.rptools.maptool.model.MacroButtonProperties>
