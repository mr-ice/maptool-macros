<net.rptools.maptool.model.MacroButtonProperties>
  <macroUUID>ff6e6b7a-50e7-4611-bea5-c0d6c8ea8036</macroUUID>
  <saveLocation>Token</saveLocation>
  <index>67</index>
  <colorKey>default</colorKey>
  <hotKey>None</hotKey>
  <command>[h: toon = arg (0)]
[h: modifier = arg (1)]

&lt;!-- For now, we assume its of type 'bonus'. We may need to revisit this if we find others --&gt;
[h: bonus = 0]
&lt;!-- Check fixedValue. If its numeric, use that. --&gt;
[h: fixedValue = json.get (modifier, "fixedValue")]
[h, if (fixedValue != "" &amp;&amp; isNumber (fixedValue)): bonus = fixedValue]

&lt;!-- If nothing found in fixedValue, check value --&gt;
[h: value = json.get (modifier, "value")]
[h, if (value != "" &amp;&amp; isNumber (value)): bonus = value]

&lt;!-- Still nothing? check statId and apply the bonus for the relevant stat bonus --&gt;
[h: statId = json.get (modifier, "statId")]
[h, if (statId != "" &amp;&amp; isNumber (statId)), code: {
	[h: statBonus = 0]
	[h: abilities = dndb_getAbilities (toon)]
	[h, switch (statId):
		case 1: statBonus = json.get (abilities, "strBonus");
		case 2: statBonus = json.get (abilities, "dexBonus");
		case 3: statBonus = json.get (abilities, "conBonus");
		case 4: statBonus = json.get (abilities, "intBonus");
		case 5: statBonus = json.get (abilities, "wisBonus");
		case 6: statBonus = json.get (abilities, "chaBonus")]
	[h, if (statBonus &gt; 0): bonus = statBonus]
}]

&lt;!-- return default bonus of 0 --&gt;
[h: macro.return = bonus]</command>
  <label>dndb_getModValue</label>
  <group>Utility</group>
  <sortby/>
  <autoExecute>true</autoExecute>
  <includeLabel>false</includeLabel>
  <applyToTokens>false</applyToTokens>
  <fontColorKey>black</fontColorKey>
  <fontSize>1.00em</fontSize>
  <minWidth/>
  <maxWidth/>
  <allowPlayerEdits>false</allowPlayerEdits>
  <toolTip>Given a modifier, determine the numeric value it provides. Returns 0 if value is not numeric (like advantage and disadvantage)

toon = arg (0)
modifier = arg (1)</toolTip>
  <displayHotKey>true</displayHotKey>
  <commonMacro>false</commonMacro>
  <compareGroup>true</compareGroup>
  <compareSortPrefix>true</compareSortPrefix>
  <compareCommand>true</compareCommand>
  <compareIncludeLabel>true</compareIncludeLabel>
  <compareAutoExecute>true</compareAutoExecute>
  <compareApplyToSelectedTokens>true</compareApplyToSelectedTokens>
</net.rptools.maptool.model.MacroButtonProperties>
